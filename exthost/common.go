package exthost

import (
	"fmt"
	"github.com/steadybit/action-kit/go/action_kit_api/v2"
	extension_kit "github.com/steadybit/extension-kit"
	"github.com/steadybit/extension-kit/extutil"
	"os"
)

const (
	TargetID     = "host"
	targetIcon   = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11.65%202.064a.993.993%200%2001.7%200l10%203.776a1.01%201.01%200%20010%201.889l-10%203.773a.993.993%200%2001-.7%200l-10-3.773A1.008%201.008%200%20011%206.784c0-.42.259-.796.65-.944l10-3.776zM1.063%2017.03a.998.998%200%20011.287-.591L12%2020.082l9.649-3.644a.998.998%200%20011.287.59%201.01%201.01%200%2001-.586%201.299l-10%203.776a.993.993%200%2001-.7%200l-10-3.776a1.01%201.01%200%2001-.586-1.298zm1.287-5.89a.998.998%200%2000-1.287.59%201.01%201.01%200%2000.586%201.299l10%203.776a.993.993%200%2000.7%200l10-3.776a1.01%201.01%200%2000.586-1.298.998.998%200%2000-1.287-.59L12%2014.782l-9.649-3.644z%22%20fill%3D%22currentColor%22%2F%3E%3C%2Fsvg%3E"
	basePath     = "/host"
	BaseActionID = "com.github.steadybit.extension_host"

	shutdownActionID = BaseActionID + ".shutdown"
	shutdownIcon     = "data:image/svg+xml,%3Csvg%20width%3D%2219%22%20height%3D%2222%22%20viewBox%3D%220%200%2019%2022%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M9.23122%200C9.64544%200%209.98122%200.335786%209.98122%200.75V10.0536C9.98122%2010.4678%209.64544%2010.8036%209.23122%2010.8036C8.81701%2010.8036%208.48122%2010.4678%208.48122%2010.0536V0.75C8.48122%200.335786%208.81701%200%209.23122%200ZM11.3867%203.85221C11.5248%203.46167%2011.9533%203.25699%2012.3438%203.39503C14.1646%204.03861%2015.741%205.23087%2016.856%206.8076C17.971%208.38434%2018.5697%2010.268%2018.5697%2012.1991C18.5697%2014.1303%2017.971%2016.0139%2016.856%2017.5907C15.741%2019.1674%2014.1646%2020.3597%2012.3438%2021.0032L12.3345%2021.0065C10.0089%2021.7942%207.46664%2021.6342%205.2581%2020.5613C3.04956%2019.4884%201.35239%2017.5889%200.533964%2015.274C-0.284465%2012.9591%20-0.158301%2010.415%200.885145%208.19237C1.92859%205.96978%203.80537%204.24753%206.10922%203.39843C6.49787%203.25518%206.92906%203.45413%207.07231%203.84279C7.21555%204.23145%207.0166%204.66264%206.62794%204.80588C4.69413%205.5186%203.11881%206.96422%202.24296%208.82983C1.36711%2010.6954%201.26121%2012.8309%201.94818%2014.774C2.63515%2016.7171%204.05973%2018.3115%205.91353%2019.2121C7.76584%2020.1119%209.89777%2020.2466%2011.8485%2019.5874C13.3749%2019.0468%2014.6963%2018.0467%2015.6313%2016.7246C16.5672%2015.4011%2017.0697%2013.8201%2017.0697%2012.1991C17.0697%2010.5782%2016.5672%208.99713%2015.6313%207.67367C14.6954%206.35022%2013.3722%205.34948%2011.8439%204.80928C11.4534%204.67124%2011.2487%204.24274%2011.3867%203.85221Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"

	timeTravelActionID = BaseActionID + ".timetravel"
	timeTravelIcon     = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M12.75%208C12.75%207.58579%2012.4142%207.25%2012%207.25C11.5858%207.25%2011.25%207.58579%2011.25%208V12.3107L15.9697%2017.0303C16.2626%2017.3232%2016.7374%2017.3232%2017.0303%2017.0303C17.3232%2016.7374%2017.3232%2016.2626%2017.0303%2015.9697L12.75%2011.6893V8Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M12%200.75C5.78679%200.75%200.75%205.78679%200.75%2012C0.75%2018.2132%205.78679%2023.25%2012%2023.25C18.2132%2023.25%2023.25%2018.2132%2023.25%2012C23.25%205.78679%2018.2132%200.75%2012%200.75ZM2.25%2012C2.25%206.61521%206.61521%202.25%2012%202.25C17.3848%202.25%2021.75%206.61521%2021.75%2012C21.75%2017.3848%2017.3848%2021.75%2012%2021.75C6.61521%2021.75%202.25%2017.3848%202.25%2012Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"

	stressCPUIcon    = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M5.25%204.5C4.83579%204.5%204.5%204.83579%204.5%205.25V18.75C4.5%2019.1642%204.83579%2019.5%205.25%2019.5H18.75C19.1642%2019.5%2019.5%2019.1642%2019.5%2018.75V5.25C19.5%204.83579%2019.1642%204.5%2018.75%204.5H5.25ZM3%205.25C3%204.00736%204.00736%203%205.25%203H18.75C19.9926%203%2021%204.00736%2021%205.25V18.75C21%2019.9926%2019.9926%2021%2018.75%2021H5.25C4.00736%2021%203%2019.9926%203%2018.75V5.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M12%200.75C12.4142%200.75%2012.75%201.08579%2012.75%201.5V3.75C12.75%204.16421%2012.4142%204.5%2012%204.5C11.5858%204.5%2011.25%204.16421%2011.25%203.75V1.5C11.25%201.08579%2011.5858%200.75%2012%200.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M6.75%200.75C7.16421%200.75%207.5%201.08579%207.5%201.5V3.75C7.5%204.16421%207.16421%204.5%206.75%204.5C6.33579%204.5%206%204.16421%206%203.75V1.5C6%201.08579%206.33579%200.75%206.75%200.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M17.25%200.75C17.6642%200.75%2018%201.08579%2018%201.5V3.75C18%204.16421%2017.6642%204.5%2017.25%204.5C16.8358%204.5%2016.5%204.16421%2016.5%203.75V1.5C16.5%201.08579%2016.8358%200.75%2017.25%200.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M12%2019.5C12.4142%2019.5%2012.75%2019.8358%2012.75%2020.25V22.5C12.75%2022.9142%2012.4142%2023.25%2012%2023.25C11.5858%2023.25%2011.25%2022.9142%2011.25%2022.5V20.25C11.25%2019.8358%2011.5858%2019.5%2012%2019.5Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M6.75%2019.5C7.16421%2019.5%207.5%2019.8358%207.5%2020.25V22.5C7.5%2022.9142%207.16421%2023.25%206.75%2023.25C6.33579%2023.25%206%2022.9142%206%2022.5V20.25C6%2019.8358%206.33579%2019.5%206.75%2019.5Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M17.25%2019.5C17.6642%2019.5%2018%2019.8358%2018%2020.25V22.5C18%2022.9142%2017.6642%2023.25%2017.25%2023.25C16.8358%2023.25%2016.5%2022.9142%2016.5%2022.5V20.25C16.5%2019.8358%2016.8358%2019.5%2017.25%2019.5Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M19.5%2012C19.5%2011.5858%2019.8358%2011.25%2020.25%2011.25H22.5C22.9142%2011.25%2023.25%2011.5858%2023.25%2012C23.25%2012.4142%2022.9142%2012.75%2022.5%2012.75H20.25C19.8358%2012.75%2019.5%2012.4142%2019.5%2012Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M19.5%2017.25C19.5%2016.8358%2019.8358%2016.5%2020.25%2016.5H22.5C22.9142%2016.5%2023.25%2016.8358%2023.25%2017.25C23.25%2017.6642%2022.9142%2018%2022.5%2018H20.25C19.8358%2018%2019.5%2017.6642%2019.5%2017.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M19.5%206.75C19.5%206.33579%2019.8358%206%2020.25%206H22.5C22.9142%206%2023.25%206.33579%2023.25%206.75C23.25%207.16421%2022.9142%207.5%2022.5%207.5H20.25C19.8358%207.5%2019.5%207.16421%2019.5%206.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M0.75%2012C0.75%2011.5858%201.08579%2011.25%201.5%2011.25H3.75C4.16421%2011.25%204.5%2011.5858%204.5%2012C4.5%2012.4142%204.16421%2012.75%203.75%2012.75H1.5C1.08579%2012.75%200.75%2012.4142%200.75%2012Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M0.75%2017.25C0.75%2016.8358%201.08579%2016.5%201.5%2016.5H3.75C4.16421%2016.5%204.5%2016.8358%204.5%2017.25C4.5%2017.6642%204.16421%2018%203.75%2018H1.5C1.08579%2018%200.75%2017.6642%200.75%2017.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M0.75%206.75C0.75%206.33579%201.08579%206%201.5%206H3.75C4.16421%206%204.5%206.33579%204.5%206.75C4.5%207.16421%204.16421%207.5%203.75%207.5H1.5C1.08579%207.5%200.75%207.16421%200.75%206.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M8.25%207.5C7.83579%207.5%207.5%207.83579%207.5%208.25V15.75C7.5%2016.1642%207.83579%2016.5%208.25%2016.5H15.75C16.1642%2016.5%2016.5%2016.1642%2016.5%2015.75V8.25C16.5%207.83579%2016.1642%207.5%2015.75%207.5H8.25ZM6%208.25C6%207.00736%207.00736%206%208.25%206H15.75C16.9926%206%2018%207.00736%2018%208.25V15.75C18%2016.9926%2016.9926%2018%2015.75%2018H8.25C7.00736%2018%206%2016.9926%206%2015.75V8.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11.25%2014.25C11.25%2013.8358%2011.5858%2013.5%2012%2013.5H14.25C14.6642%2013.5%2015%2013.8358%2015%2014.25C15%2014.6642%2014.6642%2015%2014.25%2015H12C11.5858%2015%2011.25%2014.6642%2011.25%2014.25Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"
	stressIOIcon     = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M18.375%2017.625C18.3008%2017.625%2018.2283%2017.647%2018.1667%2017.6882C18.105%2017.7294%2018.0569%2017.788%2018.0285%2017.8565C18.0002%2017.925%2017.9927%2018.0004%2018.0072%2018.0732C18.0217%2018.1459%2018.0574%2018.2127%2018.1098%2018.2652C18.1623%2018.3176%2018.2291%2018.3533%2018.3018%2018.3678C18.3746%2018.3823%2018.45%2018.3748%2018.5185%2018.3465C18.587%2018.3181%2018.6456%2018.27%2018.6868%2018.2083C18.728%2018.1467%2018.75%2018.0742%2018.75%2018C18.75%2017.9005%2018.7105%2017.8052%2018.6402%2017.7348C18.5698%2017.6645%2018.4745%2017.625%2018.375%2017.625Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20d%3D%22M15%2017.625C14.9258%2017.625%2014.8533%2017.647%2014.7917%2017.6882C14.73%2017.7294%2014.6819%2017.788%2014.6535%2017.8565C14.6252%2017.925%2014.6177%2018.0004%2014.6322%2018.0732C14.6467%2018.1459%2014.6824%2018.2127%2014.7348%2018.2652C14.7873%2018.3176%2014.8541%2018.3533%2014.9268%2018.3678C14.9996%2018.3823%2015.075%2018.3748%2015.1435%2018.3465C15.212%2018.3181%2015.2706%2018.27%2015.3118%2018.2083C15.353%2018.1467%2015.375%2018.0742%2015.375%2018C15.375%2017.9005%2015.3355%2017.8052%2015.2652%2017.7348C15.1948%2017.6645%2015.0995%2017.625%2015%2017.625Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M14.375%2017.0646C14.56%2016.941%2014.7775%2016.875%2015%2016.875C15.2984%2016.875%2015.5845%2016.9935%2015.7955%2017.2045C16.0065%2017.4155%2016.125%2017.7016%2016.125%2018C16.125%2018.2225%2016.059%2018.44%2015.9354%2018.625C15.8118%2018.81%2015.6361%2018.9542%2015.4305%2019.0394C15.225%2019.1245%2014.9988%2019.1468%2014.7805%2019.1034C14.5623%2019.06%2014.3618%2018.9528%2014.2045%2018.7955C14.0472%2018.6382%2013.94%2018.4377%2013.8966%2018.2195C13.8532%2018.0012%2013.8755%2017.775%2013.9606%2017.5695C14.0458%2017.3639%2014.19%2017.1882%2014.375%2017.0646ZM15.1435%2018.3465C15.1661%2018.3371%2015.1878%2018.3255%2015.2083%2018.3118C15.2495%2018.2843%2015.2846%2018.2491%2015.3118%2018.2083C15.3254%2018.188%2015.337%2018.1663%2015.3465%2018.1435C15.3654%2018.0978%2015.375%2018.049%2015.375%2018C15.375%2017.9756%2015.3726%2017.951%2015.3678%2017.9268C15.3533%2017.8541%2015.3176%2017.7873%2015.2652%2017.7348C15.2127%2017.6824%2015.1459%2017.6467%2015.0732%2017.6322C15.0489%2017.6274%2015.0244%2017.625%2015%2017.625C14.951%2017.625%2014.9022%2017.6346%2014.8565%2017.6535C14.8337%2017.663%2014.812%2017.6746%2014.7917%2017.6882C14.7509%2017.7154%2014.7157%2017.7505%2014.6882%2017.7917C14.6745%2017.8122%2014.6629%2017.8339%2014.6535%2017.8565C14.6348%2017.9018%2014.625%2017.9505%2014.625%2018C14.625%2018.0247%2014.6274%2018.0492%2014.6322%2018.0732C14.6467%2018.1459%2014.6824%2018.2127%2014.7348%2018.2652C14.7873%2018.3176%2014.8541%2018.3533%2014.9268%2018.3678C14.9508%2018.3726%2014.9753%2018.375%2015%2018.375C15.0495%2018.375%2015.0982%2018.3652%2015.1435%2018.3465Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M5.25%2014.25C4.25544%2014.25%203.30161%2014.6451%202.59835%2015.3484C1.89509%2016.0516%201.5%2017.0054%201.5%2018C1.5%2018.9946%201.89509%2019.9484%202.59835%2020.6516C3.30161%2021.3549%204.25544%2021.75%205.25%2021.75H18.75C19.7446%2021.75%2020.6984%2021.3549%2021.4016%2020.6516C22.1049%2019.9484%2022.5%2018.9946%2022.5%2018C22.5%2017.0054%2022.1049%2016.0516%2021.4016%2015.3484C20.6984%2014.6451%2019.7446%2014.25%2018.75%2014.25H5.25ZM1.53769%2014.2877C2.52226%2013.3031%203.85761%2012.75%205.25%2012.75H18.75C20.1424%2012.75%2021.4777%2013.3031%2022.4623%2014.2877C23.4469%2015.2723%2024%2016.6076%2024%2018C24%2019.3924%2023.4469%2020.7277%2022.4623%2021.7123C21.4777%2022.6969%2020.1424%2023.25%2018.75%2023.25H5.25C3.85761%2023.25%202.52226%2022.6969%201.53769%2021.7123C0.553123%2020.7277%200%2019.3924%200%2018C0%2016.6076%200.553123%2015.2723%201.53769%2014.2877Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M6.87806%200.75C6.87804%200.75%206.87808%200.75%206.87806%200.75H17.123C17.9685%200.750211%2018.7894%201.03617%2019.4519%201.56146C20.1145%202.08673%2020.5801%202.82048%2020.7732%203.64364C20.7732%203.6436%2020.7732%203.64368%2020.7732%203.64364L23.8612%2016.8016C23.9558%2017.2049%2023.7056%2017.6085%2023.3024%2017.7032C22.8991%2017.7978%2022.4955%2017.5476%2022.4008%2017.1444L19.3128%203.98636C19.197%203.49244%2018.9176%203.05205%2018.5201%202.73688C18.1226%202.42174%2017.6303%202.25017%2017.123%202.25C17.1229%202.25%2017.1231%202.25%2017.123%202.25H6.878C6.37055%202.24996%205.87792%202.42145%205.48022%202.73664C5.08253%203.05183%204.80306%203.4922%204.68719%203.98625L1.59916%2017.1444C1.50452%2017.5476%201.1009%2017.7978%200.697641%2017.7032C0.294384%2017.6085%200.0441994%2017.2049%200.138838%2016.8016L3.22681%203.64375C3.2268%203.64379%203.22682%203.64371%203.22681%203.64375C3.41994%202.82038%203.88574%202.08637%204.54854%201.56107C5.21135%201.03577%206.03233%200.749943%206.87806%200.75Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M4.5%2018C4.5%2017.5858%204.83579%2017.25%205.25%2017.25H9C9.41421%2017.25%209.75%2017.5858%209.75%2018C9.75%2018.4142%209.41421%2018.75%209%2018.75H5.25C4.83579%2018.75%204.5%2018.4142%204.5%2018Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"
	stressMemoryIcon = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2224%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M17.1063%201.49823C16.9943%201.49823%2016.8834%201.52037%2016.7799%201.56338C16.6765%201.6064%2016.5826%201.66943%2016.5036%201.74886L16.5019%201.75054L10.5432%207.70453L10.5609%207.78931C10.6379%208.16975%2010.6196%208.56331%2010.5077%208.93498C10.3958%209.30665%2010.1938%209.64491%209.91967%209.91966C9.6455%2010.1944%209.30767%2010.3971%208.93624%2010.5098C8.56481%2010.6225%208.17129%2010.6416%207.79069%2010.5654L7.78392%2010.5641L7.70419%2010.5473L1.75019%2016.5023L1.74867%2016.5038C1.66924%2016.5828%201.60621%2016.6767%201.5632%2016.7801C1.52019%2016.8836%201.49805%2016.9945%201.49805%2017.1065C1.49805%2017.2185%201.52019%2017.3294%201.5632%2017.4329C1.60621%2017.5363%201.66924%2017.6302%201.74867%2017.7092L1.75015%2017.7107L6.29061%2022.2511C6.3696%2022.3306%206.46351%2022.3936%206.56695%2022.4366C6.67038%2022.4796%206.78129%2022.5018%206.89331%2022.5018C7.00534%2022.5018%207.11625%2022.4796%207.21968%2022.4366C7.32312%2022.3936%207.41703%2022.3306%207.49602%2022.2511L7.49748%2022.2497L22.2495%207.49767L22.251%207.4962C22.3304%207.41721%2022.3934%207.3233%2022.4364%207.21987C22.4794%207.11644%2022.5016%207.00552%2022.5016%206.8935C22.5016%206.78147%2022.4794%206.67056%2022.4364%206.56713C22.3934%206.4637%2022.3304%206.36978%2022.251%206.29079L22.2495%206.28933L17.7105%201.75033L17.709%201.74886C17.63%201.66943%2017.5361%201.60639%2017.4327%201.56338C17.3292%201.52037%2017.2183%201.49823%2017.1063%201.49823ZM16.204%200.178361C16.49%200.0594469%2016.7966%20-0.00177002%2017.1063%20-0.00177002C17.416%20-0.00177002%2017.7227%200.0594468%2018.0086%200.178361C18.2942%200.297124%2018.5536%200.4711%2018.7718%200.690304L18.7726%200.691138L23.3087%205.2272L23.3094%205.22795C23.5287%205.44618%2023.7027%205.70555%2023.8214%205.99119C23.9404%206.27715%2024.0016%206.5838%2024.0016%206.8935C24.0016%207.2032%2023.9404%207.50984%2023.8214%207.79581C23.7027%208.08145%2023.5287%208.34082%2023.3094%208.55905L23.3087%208.55979L8.55961%2023.3089L8.55886%2023.3096C8.34063%2023.5289%208.08126%2023.7029%207.79563%2023.8216C7.50966%2023.9405%207.20301%2024.0018%206.89331%2024.0018C6.58362%2024.0018%206.27697%2023.9405%205.991%2023.8216C5.70537%2023.7029%205.446%2023.5289%205.22777%2023.3096L5.22702%2023.3089L0.690955%2018.7728L0.690121%2018.772C0.470917%2018.5538%200.296941%2018.2944%200.178177%2018.0088C0.0592636%2017.7228%20-0.00195312%2017.4162%20-0.00195312%2017.1065C-0.00195312%2016.7968%200.0592638%2016.4901%200.178177%2016.2042C0.296919%2015.9186%200.470851%2015.6593%200.689999%2015.4412L0.690955%2015.4402L6.93044%209.19971C7.1095%209.02062%207.36684%208.94399%207.6147%208.99595L8.08778%209.09513C8.22508%209.12212%208.36692%209.115%208.50084%209.07437C8.6357%209.03347%208.75835%208.95987%208.85789%208.86012C8.95742%208.76037%209.03076%208.63756%209.07138%208.50263C9.11179%208.36839%209.11857%208.22629%209.09113%208.08884L8.99177%207.61488C8.93979%207.36694%209.01649%207.10952%209.1957%206.93045L15.44%200.691138L15.4411%200.690074C15.6592%200.470977%2015.9185%200.297082%2016.204%200.178361Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M7.49725%2015.4419C7.79001%2015.1489%208.26489%2015.1487%208.55791%2015.4414L9.69291%2016.5754C9.83364%2016.716%209.91275%2016.9068%209.91281%2017.1058C9.91288%2017.3047%209.8339%2017.4955%209.69326%2017.6362L7.42426%2019.9062C7.28362%2020.0469%207.09284%2020.126%206.8939%2020.126C6.69496%2020.126%206.50416%2020.047%206.36348%2019.9063L5.22848%2018.7713C4.93559%2018.4784%204.93559%2018.0036%205.22848%2017.7107C5.52138%2017.4178%205.99625%2017.4178%206.28914%2017.7107L6.8937%2018.3152L8.10204%2017.1063L7.49772%2016.5026C7.2047%2016.2098%207.20449%2015.7349%207.49725%2015.4419Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M17.7105%205.22867C18.0034%204.93577%2018.4782%204.93577%2018.7711%205.22867L19.9061%206.36367C20.0468%206.50434%2020.1258%206.69514%2020.1258%206.89408C20.1258%207.09302%2020.0467%207.2838%2019.906%207.42444L17.636%209.69344C17.4953%209.83409%2017.3045%209.91306%2017.1056%209.913C16.9066%209.91293%2016.7159%209.83383%2016.5753%209.69309L15.4413%208.55809C15.1485%208.26507%2015.1487%207.7902%2015.4417%207.49743C15.7347%207.20467%2016.2096%207.20488%2016.5024%207.4979L17.1062%208.10222L18.315%206.89388L17.7105%206.28933C17.4176%205.99643%2017.4176%205.52156%2017.7105%205.22867Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M13.1715%209.76767C13.4644%209.47477%2013.9392%209.47477%2014.2321%209.76767L15.3671%2010.9027C15.5078%2011.0433%2015.5868%2011.2341%2015.5868%2011.433C15.5868%2011.6319%2015.5078%2011.8227%2015.3671%2011.9633L11.9631%2015.3673C11.8225%2015.508%2011.6317%2015.587%2011.4328%2015.587C11.2339%2015.587%2011.0431%2015.508%2010.9025%2015.3673L9.76748%2014.2323C9.47459%2013.9394%209.47459%2013.4646%209.76748%2013.1717C10.0604%2012.8788%2010.5353%2012.8788%2010.8281%2013.1717L11.4328%2013.7763L13.7762%2011.433L13.1715%2010.8283C12.8786%2010.5354%2012.8786%2010.0606%2013.1715%209.76767Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M1.82472%2014.3064C2.11774%2014.0137%202.59261%2014.0139%202.88538%2014.3069L4.01938%2015.4419C4.31214%2015.7349%204.31193%2016.2098%204.01891%2016.5026C3.72589%2016.7953%203.25101%2016.7951%202.95825%2016.5021L1.82425%2015.3671C1.53149%2015.0741%201.5317%2014.5992%201.82472%2014.3064Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M4.09348%2012.0367C4.38638%2011.7438%204.86125%2011.7438%205.15414%2012.0367L6.28914%2013.1717C6.58204%2013.4646%206.58204%2013.9394%206.28914%2014.2323C5.99625%2014.5252%205.52138%2014.5252%205.22848%2014.2323L4.09348%2013.0973C3.80059%2012.8044%203.80059%2012.3296%204.09348%2012.0367Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M12.0365%204.09367C12.3294%203.80077%2012.8043%203.80077%2013.0971%204.09367L14.2321%205.22867C14.525%205.52156%2014.525%205.99643%2014.2321%206.28933C13.9392%206.58222%2013.4644%206.58222%2013.1715%206.28933L12.0365%205.15433C11.7436%204.86143%2011.7436%204.38656%2012.0365%204.09367Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M14.3063%201.8249C14.599%201.53188%2015.0739%201.53167%2015.3669%201.82443L16.5019%202.95843C16.7949%203.2512%2016.7951%203.72607%2016.5024%204.01909C16.2096%204.31212%2015.7347%204.31232%2015.4417%204.01956L14.3067%202.88556C14.0137%202.5928%2014.0135%202.11792%2014.3063%201.8249Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"

	stopProcessActionID = BaseActionID + ".stop-process"
	stopProcessIcon     = "data:image/svg+xml,%3Csvg%20width%3D%2222%22%20height%3D%2222%22%20viewBox%3D%220%200%2022%2022%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20d%3D%22M9%208C8.44772%208%208%208.44772%208%209V13C8%2013.5523%208.44772%2014%209%2014H13C13.5523%2014%2014%2013.5523%2014%2013V9C14%208.44772%2013.5523%208%2013%208H9Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M11%200.250015C5.06312%200.250015%200.25%205.06314%200.25%2011C0.25%2016.9369%205.06312%2021.75%2011%2021.75C16.9369%2021.75%2021.75%2016.9369%2021.75%2011C21.75%205.06314%2016.9369%200.250015%2011%200.250015ZM1.75%2011C1.75%205.89156%205.89155%201.75002%2011%201.75002C16.1085%201.75002%2020.25%205.89156%2020.25%2011C20.25%2016.1085%2016.1085%2020.25%2011%2020.25C5.89155%2020.25%201.75%2016.1085%201.75%2011Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"
	blackHoleIcon       = "data:image/svg+xml,%3Csvg%20width%3D%2224%22%20height%3D%2218%22%20viewBox%3D%220%200%2024%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M1.96299%201.55709C2.24324%201.441%202.56583%201.50517%202.78033%201.71967L4.06066%203H6.75C7.16421%203%207.5%203.33579%207.5%203.75C7.5%204.16421%207.16421%204.5%206.75%204.5H4.06066L2.78033%205.78033C2.56583%205.99483%202.24324%206.059%201.96299%205.94291C1.68273%205.82682%201.5%205.55335%201.5%205.25V4.5H0.75C0.335786%204.5%200%204.16421%200%203.75C0%203.33579%200.335786%203%200.75%203H1.5V2.25C1.5%201.94665%201.68273%201.67318%201.96299%201.55709ZM14.267%205.09123C14.3417%204.7462%2014.647%204.5%2015%204.5H16.5C16.6275%204.5%2016.7528%204.53248%2016.8642%204.59438L23.6012%208.33712C23.6195%208.34685%2023.6374%208.35732%2023.6548%208.36849C23.704%208.39998%2023.7498%208.4374%2023.791%208.48033C23.8285%208.51937%2023.8614%208.56204%2023.8892%208.60743C23.9322%208.67737%2023.9641%208.75492%2023.9824%208.83759C23.9888%208.86671%2023.9926%208.88844%2023.9955%208.91775C24.0037%208.9996%2024.0005%209.08352%2023.9824%209.16241C23.9641%209.24508%2023.9322%209.32263%2023.8892%209.39257C23.8614%209.43796%2023.8285%209.48063%2023.791%209.51967C23.7498%209.5626%2023.704%209.60002%2023.6548%209.63151C23.6374%209.64268%2023.6195%209.65315%2023.6012%209.66288L16.8642%2013.4056C16.7528%2013.4675%2016.6275%2013.5%2016.5%2013.5H15C14.647%2013.5%2014.3417%2013.2538%2014.267%2012.9088C14.1923%2012.5637%2014.3683%2012.2133%2014.6896%2012.0672L19.7875%209.75H11.25C10.8358%209.75%2010.5%209.41421%2010.5%209C10.5%208.58579%2010.8358%208.25%2011.25%208.25H19.7875L14.6896%205.93278C14.3683%205.78669%2014.1923%205.43625%2014.267%205.09123ZM3.46299%206.80709C3.74324%206.69101%204.06583%206.75517%204.28033%206.96967L5.56066%208.25H6C6.41421%208.25%206.75%208.58579%206.75%209C6.75%209.41421%206.41421%209.75%206%209.75H5.56066L4.28033%2011.0303C4.06583%2011.2448%203.74324%2011.309%203.46299%2011.1929C3.18273%2011.0768%203%2010.8033%203%2010.5V9.75H0.75C0.335786%209.75%200%209.41421%200%209C0%208.58579%200.335786%208.25%200.75%208.25H3V7.5C3%207.19665%203.18273%206.92318%203.46299%206.80709ZM1.96299%2012.0571C2.24324%2011.941%202.56583%2012.0052%202.78033%2012.2197L4.06066%2013.5H6.75C7.16421%2013.5%207.5%2013.8358%207.5%2014.25C7.5%2014.6642%207.16421%2015%206.75%2015H4.06066L2.78033%2016.2803C2.56583%2016.4948%202.24324%2016.559%201.96299%2016.4429C1.68273%2016.3268%201.5%2016.0533%201.5%2015.75V15H0.75C0.335786%2015%200%2014.6642%200%2014.25C0%2013.8358%200.335786%2013.5%200.75%2013.5H1.5V12.75C1.5%2012.4467%201.68273%2012.1732%201.96299%2012.0571Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M10.8582%202.0271C12.2166%201.19193%2013.7799%200.749779%2015.3745%200.749779C16.9691%200.749779%2018.5324%201.19193%2019.8908%202.0271L19.9001%202.03282C21.8129%203.24755%2023.1708%205.16617%2023.6806%207.37395C24.1903%209.58172%2023.8109%2011.9014%2022.6243%2013.8318C21.4378%2015.7621%2019.5393%2017.148%2017.3393%2017.6901C15.1392%2018.2322%2012.8142%2017.8868%2010.8667%2016.7286C10.5106%2016.5169%2010.3937%2016.0567%2010.6054%2015.7007C10.8171%2015.3446%2011.2773%2015.2277%2011.6333%2015.4394C13.2422%2016.3961%2015.1629%2016.6814%2016.9804%2016.2337C18.7979%2015.7859%2020.3662%2014.6409%2021.3465%2013.0463C22.3267%2011.4516%2022.6401%209.53527%2022.219%207.7114C21.7983%205.88932%2020.6782%204.3057%2019.1005%203.30205C17.9795%202.61401%2016.6899%202.24978%2015.3745%202.24978C14.0573%202.24978%2012.7659%202.61502%2011.6438%203.3049C11.291%203.52185%2010.829%203.41167%2010.6121%203.05881C10.3952%202.70596%2010.5053%202.24404%2010.8582%202.0271Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3Cpath%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%20d%3D%22M9.55202%206.73421C9.22595%207.27773%209%208.07701%209%209C9%209.92299%209.22595%2010.7223%209.55202%2011.2658C9.88701%2011.8242%2010.2454%2012%2010.5%2012C10.7546%2012%2011.113%2011.8242%2011.448%2011.2658C11.7741%2010.7223%2012%209.92299%2012%209C12%208.07701%2011.7741%207.27773%2011.448%206.73421C11.113%206.17582%2010.7546%206%2010.5%206C10.2454%206%209.88701%206.17582%209.55202%206.73421ZM8.26573%205.96254C8.74499%205.16368%209.51158%204.5%2010.5%204.5C11.4884%204.5%2012.255%205.16368%2012.7343%205.96254C13.2224%206.77627%2013.5%207.85199%2013.5%209C13.5%2010.148%2013.2224%2011.2237%2012.7343%2012.0375C12.255%2012.8363%2011.4884%2013.5%2010.5%2013.5C9.51158%2013.5%208.74499%2012.8363%208.26573%2012.0375C7.77755%2011.2237%207.5%2010.148%207.5%209C7.5%207.85199%207.77755%206.77627%208.26573%205.96254Z%22%20fill%3D%22%231D2632%22%2F%3E%0A%3C%2Fsvg%3E%0A"
)

var (
	targetSelectionTemplates = []action_kit_api.TargetSelectionTemplate{
		{
			Label:       "by host name",
			Description: extutil.Ptr("Find host by host name."),
			Query:       "host.hostname=\"\"",
		},
	}

	osHostname = os.Hostname
)

func CheckTargetHostname(attributes map[string][]string) (*string, error) {
	hostname := attributes["host.hostname"]
	if len(hostname) == 0 || hostname[0] == "" {
		return nil, extension_kit.ToError("Target is missing the 'host.hostname' attribute.", nil)
	}
	osHostname, err := osHostname()
	if err != nil {
		return nil, extension_kit.ToError("Failed to get hostname.", err)
	}
	if hostname[0] != osHostname {
		return nil, extension_kit.ToError(fmt.Sprintf("Target (%s) is not the current host (%s).", hostname[0], osHostname), nil)
	}
	return nil, nil
}
